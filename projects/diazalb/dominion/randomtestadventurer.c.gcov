        -:    0:Source:randomtestadventurer.c
        -:    0:Graph:randomtestadventurer.gcno
        -:    0:Data:randomtestadventurer.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include <stdlib.h>
        -:    2:#include <stdio.h>
        -:    3:#include <time.h>
        -:    4:#include <string.h>
        -:    5:#include "dominion.h"
        -:    6:#include "dominion_helpers.h"
        -:    7:#include "rngs.h"
        -:    8:
        -:    9:#define tests 10000
        -:   10:#define criteria 3
        -:   11:#define MAX_PLAYERS 4
        -:   12:#define TESTCARD "adventurer"
        -:   13:
        -:   14:int failed = 0;
        -:   15:
        -:   16:// function to check if two ints are equal or not
    10000:   17:void testCheck(int a, int b) {
    10000:   18:	if (a == b) {
    #####:   19:		printf("PASSED\n");
        -:   20:	}
        -:   21:	else {
    10000:   22:		printf("FAILED\n");
    10000:   23:		failed++;
        -:   24:	}
    10000:   25:}
        -:   26:
        1:   27:int main()
        -:   28:{
        1:   29:    srand(time(NULL));
        -:   30:	int i;
        1:   31:    int failed = 0;
        -:   32:
        1:   33:	printf("\n\n");
        1:   34:	printf("---------------- Random Card Test ----------------\n\n");
        -:   35:
        1:   36:	printf("-------------- Testing Card: %s ----------------\n", TESTCARD);
    10001:   37:    for(i = 0; i < tests; i++)
        -:   38:	{
        -:   39:
        -:   40:        struct gameState afterTest;
        -:   41:		
    10000:   42:        int k[10] = {adventurer, gardens, embargo, village, steward, 
        -:   43:					mine, cutpurse, sea_hag, tribute, smithy};
        -:   44:
        -:   45:		//establish game settings into afterTest
    10000:   46:        initializeGame(MAX_PLAYERS, k, rand(), &afterTest);
        -:   47:
    10000:   48:        int player = rand() % 4;
    10000:   49:        afterTest.whoseTurn = player;
        -:   50:        
    10000:   51:        int choice1 = rand() % 50;
    10000:   52:        int choice2 = rand() % 50;
    10000:   53:        int choice3 = rand() % 50;
    10000:   54:        int handPos = rand() % MAX_HAND;
    10000:   55:		int bonus = rand() % 50;
        -:   56:		
        -:   57:		//create a copy of the initialized game before using cardEffect
        -:   58:        struct gameState beforeTest;
    10000:   59:        memcpy(&beforeTest, &afterTest, sizeof(struct gameState));
        -:   60:
        -:   61:		//use the adventurer card
    10000:   62:        cardEffect(TESTCARD, choice1, choice2, choice3, &afterTest, handPos, &bonus);
        -:   63:
        -:   64:		//test criteria 1: check for drawing only 2 cards
    10000:   65:        testCheck(afterTest.handCount[player], beforeTest.handCount[player] + 2);
        -:   66:		
        -:   67:		//test criteria 2: check for first card drawn is treasure
    10000:   68:        int card1 = afterTest.hand[player][afterTest.handCount[player] - 2];
    10000:   69:        if(card1 != gold && card1 != silver && card1 != copper)
        -:   70:		{
     8284:   71:			failed++;
     8284:   72:            printf("Criteria Failed: Player %d's first card isn't treasure.\n", player);
        -:   73:        }
        -:   74:		
        -:   75:		//test criteria 3: check for second card drawn is treasure
    10000:   76:        int card2 = afterTest.hand[player][afterTest.handCount[player] - 1];
    10000:   77:        if(card2 != gold && card2 != silver && card2 != copper)
        -:   78:		{
     8256:   79:			failed++;
     8256:   80:            printf("Criteria Failed: Player %d's second card isn't treasure.\n", player);
        -:   81:        }
        -:   82:
        -:   83:
        -:   84:    }
        -:   85:
        1:   86:    printf("Test Success Rate: %d of %d\n", tests * criteria - failed, tests * criteria);
        1:   87:}
